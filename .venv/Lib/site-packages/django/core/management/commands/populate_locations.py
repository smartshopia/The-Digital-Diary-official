# management/commands/populate_locations.py

from django.core.management.base import BaseCommand
from blog.models import Country, State
import pycountry

class Command(BaseCommand):
    help = 'Populate countries and states using pycountry'

    def handle(self, *args, **kwargs):
        # Populate countries
        for country in pycountry.countries:
            country_obj, created = Country.objects.get_or_create(name=country.name, code=country.alpha_2)
            print(f"Added country: {country_obj.name}")

        # Populate states (subdivisions)
        for subdivision in pycountry.subdivisions:
            country = Country.objects.get(code=subdivision.country_code)
            state_obj, created = State.objects.get_or_create(name=subdivision.name, code=subdivision.code, country=country)
            print(f"Added state: {state_obj.name}, {country.name}")
